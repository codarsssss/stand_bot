# Standing Bot ๐ค

Telegram-ะฑะพั, ะฟะพะทะฒะพะปัััะธะน ะพััะปะตะถะธะฒะฐัั, ั ะบะพะณะพ "ััะพะธั".

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
.
โโโ app/
โ   โโโ main.py           # ัะพัะบะฐ ะฒัะพะดะฐ
โ   โโโ config.py         # ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
โ   โโโ db.py             # ัะฐะฑะพัะฐ ั SQLite
โ   โโโ handlers.py       # ะปะพะณะธะบะฐ Telegram
โ   โโโ keyboard.py       # inline-ะบะฝะพะฟะบะธ
โ   โโโ errors.py         # ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
โ   โโโ messages.py       # ัะตะบััั ะดะปั ะธะฝัะตัะฝะฐัะธะพะฝะฐะปะธะทะฐัะธะธ
โโโ data/
โ   โโโ bot_data.db       # ะฑะฐะทะฐ ะดะฐะฝะฝัั
โ   โโโ .env              # ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
โ   โโโ .env.example      # ัะฐะฑะปะพะฝ
โโโ tests/
โ   โโโ test_db.py        # ัะตััั
โโโ .flake8               # ะฝะฐัััะพะนะบะธ ะปะธะฝัะตัะฐ
โโโ .gitignore
โโโ Dockerfile
โโโ docker-compose.yaml
โโโ Makefile
โโโ pyproject.toml        # poetry config
โโโ poetry.lock
โโโ .github/workflows/deploy.yml
```

## ๐ ะะพะผะฐะฝะดั Make

### ๐ฆ Docker

- `make build` โ ัะพะฑัะฐัั ะบะพะฝัะตะนะฝะตั
- `make up` โ ะทะฐะฟัััะธัั ะบะพะฝัะตะนะฝะตั
- `make down` โ ะพััะฐะฝะพะฒะธัั
- `make restart` โ ะฟะตัะตะทะฐะฟััะบ
- `make logs` โ ะฟะพะบะฐะทะฐัั ะปะพะณะธ
- `make shell` โ ะทะฐะนัะธ ะฒะฝัััั
- `make ps` โ ััะฐััั

### ๐ ะะฐะทัะฐะฑะพัะบะฐ

- `make install` โ Poetry-ะทะฐะฒะธัะธะผะพััะธ
- `make run` โ ะปะพะบะฐะปัะฝัะน ะทะฐะฟััะบ
- `make lint` โ flake8-ะฟัะพะฒะตัะบะฐ
- `make test` โ pytest

### โ๏ธ ะะบััะถะตะฝะธะต

- `make env` โ ะฟะพะบะฐะทะฐัั `.env`
- `make env-example` โ ัะฐะฑะปะพะฝ
- `make prepare-env` โ ัะบะพะฟะธัะพะฒะฐัั ัะฐะฑะปะพะฝ

### ๐ก ะะตะฟะปะพะน

- `make deploy` โ rsync + SSH ะฝะฐ VPS  
  ะขัะตะฑัะตััั ะฝะฐัััะพะธัั `VPS_HOST`, `VPS_USER`, `VPS_PATH` ะฒ Makefile

### ๐พ ะัะบะฐะฟ

- `make backup` โ ัะพััะฐะฝะธัั `bot_data.db` ะฒ `backup/`

---

## โ CI/CD: ะะฒัะพะผะฐัะธัะตัะบะธะน ะดะตะฟะปะพะน

ะัะธ ะบะพะผะผะธัะต ะฒ `main`:

- โ ะะฐะฟััะบะฐัััั ัะตััั (`make test`)
- โ ะะพะด ะดะตะฟะปะพะธััั ะฝะฐ VPS ัะตัะตะท SSH
- โ ะะตัะตะทะฐะฟััะบะฐะตััั ะบะพะฝัะตะนะฝะตั

ะคะฐะนะป: `.github/workflows/deploy.yml`

Secrets, ะบะพัะพััะต ะฝะฐะดะพ ะทะฐะดะฐัั ะฒ GitHub โ Settings โ Secrets:

```env
VPS_USER=user
VPS_HOST=1.2.3.4
VPS_PATH=/opt/stand_bot
VPS_SSH_KEY=<ssh-private-key>
```

---

## ๐ฉบ Healthcheck ะธ ะพัะปะฐะดะบะฐ

ะะพะผะฐะฝะดั:

- `/health` โ ะฑะพั ัะฐะฑะพัะฐะตั โ
- `/debug` โ Chat ID, Title, Username

ะะพัััะฟ: **ัะพะปัะบะพ ADMIN_CHAT_ID**  
ะฃะฟัะฐะฒะปัะตััั ัะตัะตะท `.env`:

```env
DEBUG=True
ADMIN_CHAT_ID=123456789
```

---

## ๐งช ะขะตััั

`pytest` ั ะผะพะบะฐะผะธ:

- `tests/test_db.py` ะฟัะพะฒะตััะตั SQLite
- ะธะทะพะปะธัะพะฒะฐะฝะฝะพะต ะพะบััะถะตะฝะธะต ัะตัะตะท `monkeypatch`

---

## ๐ ะะฝัะตัะฝะฐัะธะพะฝะฐะปะธะทะฐัะธั

ะัะต ะบะปััะตะฒัะต ัะพะพะฑัะตะฝะธั ะฒัะฝะตัะตะฝั ะฒ `messages.py`:

```python
MESSAGES = {
  "ru": { "enter_name": "...", "standing": "..." },
  "en": { "enter_name": "...", "standing": "..." }
}
```

ะฏะทัะบ ะทะฐะดะฐัััั ะฒ `.env`:

```env
LANG=ru
```

---

ะัะพะตะบั ะธัะฟะพะปัะทัะตั:

- Python 3.10+
- Poetry
- Docker + Compose
- GitHub Actions
- flake8 + pytest
- Telegram Bot API
- SQLite