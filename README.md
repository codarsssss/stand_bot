# Standing Bot ü§ñ

Telegram-–±–æ—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, —É –∫–æ–≥–æ "—Å—Ç–æ–∏—Ç".

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py           # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py         # –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ db.py             # —Ä–∞–±–æ—Ç–∞ —Å SQLite
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py       # –ª–æ–≥–∏–∫–∞ Telegram
‚îÇ   ‚îú‚îÄ‚îÄ keyboard.py       # inline-–∫–Ω–æ–ø–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ errors.py         # –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ bot_data.db       # –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ .env              # –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ .env.example      # —à–∞–±–ª–æ–Ω
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îî‚îÄ‚îÄ test_db.py        # —Ç–µ—Å—Ç –Ω–∞ SQLite
‚îú‚îÄ‚îÄ .flake8               # –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yaml
‚îú‚îÄ‚îÄ Makefile
‚îú‚îÄ‚îÄ pyproject.toml        # poetry config
‚îú‚îÄ‚îÄ poetry.lock
‚îî‚îÄ‚îÄ .github/workflows/deploy.yml
```

## üöÄ –ö–æ–º–∞–Ω–¥—ã Make

### üì¶ –†–∞–±–æ—Ç–∞ —Å Docker

- `make build` ‚Äî —Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- `make up` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ —Ñ–æ–Ω–µ
- `make down` ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- `make restart` ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- `make logs` ‚Äî –≤—ã–≤–µ—Å—Ç–∏ –ª–æ–≥–∏
- `make shell` ‚Äî –∑–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `make ps` ‚Äî —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### üíª –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

- `make install` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Poetry
- `make run` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ
- `make lint` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∏–ª—å –∫–æ–¥–∞ —á–µ—Ä–µ–∑ flake8
- `make test` ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å pytest —Å —Ç–µ—Å—Ç–∞–º–∏

### ‚öôÔ∏è –†–∞–±–æ—Ç–∞ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º

- `make env` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π `.env`
- `make env-example` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å `.env.example`
- `make prepare-env` ‚Äî —Å–æ–∑–¥–∞—Ç—å `.env`, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

### üì° –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

- `make deploy` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–¥ –Ω–∞ VPS –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç  
  > –ó–∞–¥–∞–π `VPS_HOST`, `VPS_USER`, `VPS_PATH` –≤ `Makefile`

### üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã

- `make backup` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–ø–∏—é `bot_data.db` –≤ –ø–∞–ø–∫—É `backup/`

### üîß CI/CD

- `make ci-build` ‚Äî —Å–æ–±—Ä–∞—Ç—å Docker-–æ–±—Ä–∞–∑ –¥–ª—è CI/CD –±–µ–∑ –∑–∞–ø—É—Å–∫–∞

## ü©∫ Healthcheck

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É `/health`  
–û—Ç–≤–µ—Ç: `‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç.` ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–∑ CI, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∏ —Ç.–¥.

## üõ† –û—Ç–ª–∞–¥–∫–∞

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `DEBUG=True` –≤ `.env`, –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `/debug`, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç:
- Chat ID
- –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞
- Username

> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –≥—Ä—É–ø–ø—ã, –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –∏ —Ç–µ—Å—Ç–æ–≤

## ‚úÖ –¢–µ—Å—Ç—ã

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è `pytest`:
- —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π (`tests/test_db.py`)
- –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `monkeypatch`

## üîê –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞

```env
BOT_TOKEN=your_telegram_bot_token
GROUP_CHAT_ID=-1001234567890
DB_PATH=data/bot_data.db
ADMIN_CHAT_ID=123456789
DEBUG=True
```

---

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

- Python 3.10
- Poetry –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- Docker + Compose
- GitHub Actions (CI/CD)
- SQLite –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- flake8 + pytest –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

## üîí –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º

–ö–æ–º–∞–Ω–¥—ã `/debug` –∏ `/health` –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `update.effective_user.id == ADMIN_CHAT_ID`  
–≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —É—Ç–µ—á–µ–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

---

## ‚úÖ CI: –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

GitHub Actions –∑–∞–ø—É—Å–∫–∞–µ—Ç `pytest` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–æ–º–º–∏—Ç–µ –≤ `main`:

```yaml
- name: Run tests
  run: make test
```

–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ `.github/workflows/deploy.yml`

---

## üåç –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —è–∑—ã–∫–∏:

üìÅ `app/messages.py`
```python
MESSAGES = {
    "ru": {
        "enter_name": "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –≤ —Ä–æ–¥–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ...",
        "standing": "–£ {name} —Å–µ–π—á–∞—Å —Å—Ç–æ–∏—Ç.",
        "not_standing": "–£ {name} –ø–µ—Ä–µ—Å—Ç–∞–ª —Å—Ç–æ—è—Ç—å.",
    },
    "en": {
        "enter_name": "Enter your name and surname...",
        "standing": "{name} is currently standing.",
        "not_standing": "{name} stopped standing.",
    },
}
```

–í—ã–±–æ—Ä —è–∑—ã–∫–∞ ‚Äî —á–µ—Ä–µ–∑ `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `LANG=ru` –∏:

```python
from app.config import LANG
from app.messages import MESSAGES

text = MESSAGES[LANG]["enter_name"]
```



## üîê –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤

–ö–æ–º–∞–Ω–¥—ã `/debug` –∏ `/health` –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å `ADMIN_CHAT_ID`.

## üåç –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è

–í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ —Ñ–∞–π–ª `messages.py`.  
–Ø–∑—ã–∫ –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```env
LANG=ru  # –∏–ª–∏ en
```

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `MESSAGES`:

```python
MESSAGES = {
    "ru": {
        "enter_name": "–í–≤–µ–¥–∏—Ç–µ –∏–º—è...",
        "standing": "–£ {name} —Å–µ–π—á–∞—Å —Å—Ç–æ–∏—Ç.",
    },
    "en": {
        "enter_name": "Enter your name...",
        "standing": "{name} is currently standing.",
    },
}
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤ –±—É–¥—É—â–µ–º —É–¥–æ–±–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —è–∑—ã–∫–∏.
